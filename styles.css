:root{
  --bg:#ffffff; /* Fondo blanco */
  --sem-bg:#ede6db; /* Bloques de semestre */
  --sem-border:#9f988e;

  --unlocked:#80aec3;        /* Ramos desbloqueados */
  --unlocked-border:#457387;

  --approved:#a2b38b;        /* Ramos aprobados */
  --approved-border:#768660;

  --blocked-bg:#eef1f3;      /* Ramos bloqueados */
  --blocked-ink:#5d6772;
  --blocked-border:#a9b2ba;

  --ink:#1c2630;
  --muted:#6b747d;

  --line:#9d5353;            /* Líneas guía */
  --line-dim: rgba(157,83,83,.25);
  --line-hi: #9d5353;

  --shadow: 0 6px 16px rgba(0,0,0,.07);
  --radius: 18px;
  --radius-sm: 12px;
}

/* Fondo blanco + tipografía Caudex en toda la malla */
html,body{ height:100%; }
body{
  margin:0;
  font-family: "Caudex", serif;
  color:var(--ink);
  background: var(--bg);
}

/* Encabezado */
.topbar{
  position:sticky; top:0; z-index:5;
  backdrop-filter: blur(6px);
  background:linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.75));
  border-bottom:1px solid #e7e1d8;
  padding:10px 16px 8px;
}
.topbar h1{
  margin:4px 0 8px;
  font-size: clamp(18px, 2.4vw, 28px);
  letter-spacing:.2px;
}
.legend{
  display:flex; gap:10px; flex-wrap:wrap;
  font-size:12px; margin-bottom:8px;
}
.legend-item{
  display:inline-flex; align-items:center; gap:8px;
  border-radius:999px; padding:6px 10px; border:1px solid #e1d8cc;
  background:#fff;
}
.legend-item::before{
  content:""; width:14px; height:14px; border-radius:4px; display:inline-block;
  border:2px solid transparent;
}
.legend-item.unlocked::before{ background:var(--unlocked); border-color:var(--unlocked-border); }
.legend-item.blocked::before{ background:var(--blocked-bg); border:2px dashed var(--blocked-border); }
.legend-item.passed::before{ background:var(--approved); border-color:var(--approved-border); }

.actions{
  display:flex; align-items:center; gap:8px; flex-wrap:wrap;
}
.btn{
  font-family:"Caudex", serif;
  padding:8px 14px; border-radius:999px; border:1px solid var(--unlocked-border);
  background: var(--unlocked);
  color:#0f2a34; cursor:pointer;
  box-shadow: var(--shadow);
  transition: transform .15s ease, box-shadow .15s ease, background-color .25s ease, border-color .25s ease;
}
.btn:hover{ transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,.08); }
.btn:active{ transform: translateY(0); }
.btn.btn-outline{
  background:#fff; color:var(--ink); border-color:#c9c2b7;
}
.hint{ color:var(--muted); }

/* Contenedor principal */
#viewport{
  position:relative;
  padding:18px 12px 40px;
  overflow:auto;
}

/* Grilla de semestres: columnas lado a lado */
#malla{
  display:grid;
  grid-auto-flow: column;
  grid-auto-columns: minmax(260px, 280px);
  gap:18px;
  align-items:start;
  position:relative;
  z-index:1; /* por encima del SVG */
}

/* Tarjeta de semestre */
.semestre{
  background: var(--sem-bg);
  border:1px solid var(--sem-border);
  border-radius: var(--radius);
  padding:12px;
  box-shadow: var(--shadow);
}
.semestre h2{
  margin:4px 6px 10px;
  font-size:18px;
  font-weight:700;
  color:#2a2a2a;
  text-align:center;
}

/* Ramo */
.ramo{
  position:relative;
  padding:10px 10px;
  border-radius: var(--radius-sm);
  margin:8px 4px;
  line-height:1.25;
  user-select:none;
  border:2px solid transparent;
  cursor:pointer;
  box-shadow: 0 1px 0 rgba(0,0,0,0.04);
  transition:
    transform .12s ease,
    box-shadow .12s ease,
    background-color .25s ease,
    border-color .25s ease,
    color .25s ease,
    filter .25s ease;
}

/* Desbloqueado */
.ramo.desbloqueado{
  background: var(--unlocked);
  border-color: var(--unlocked-border);
}
/* Bloqueado */
.ramo.bloqueado{
  background: var(--blocked-bg);
  color: var(--blocked-ink);
  border:2px dashed var(--blocked-border);
  cursor:not-allowed;
  filter:saturate(0.3);
}
/* Aprobado */
.ramo.aprobado{
  background: var(--approved) !important;
  color:#12210f;
  border-color: var(--approved-border) !important;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.2), 0 2px 6px rgba(0,0,0,.12);
}

/* Hover para desbloqueados */
.ramo.desbloqueado:not(.aprobado):hover{
  transform: scale(1.03);
  box-shadow: 0 10px 20px rgba(0,0,0,.12);
}

/* Dim cuando hay resaltado activo */
.dim .ramo:not(.is-highlight){
  filter: grayscale(.3) opacity(.6);
}

/* SVG de líneas */
#lineas{
  position:absolute; inset:0; width:100%; height:100%;
  pointer-events:none; z-index:0;
}
.link{
  stroke: var(--line);
  stroke-width: 2.2;
  fill: none;
  opacity:.65;
  transition: stroke-width .2s ease, opacity .2s ease, stroke .2s ease;
}
.link.dim{ opacity:.18; stroke: var(--line-dim); }
.link.highlight{
  opacity:.95;
  stroke-width: 3.6;
  stroke: var(--line-hi);
}

/* Footer */
.foot{
  padding:14px 16px 24px;
  color:var(--muted);
  text-align:center;
}
