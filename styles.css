:root{
  --bg:#ffffff; /* Fondo blanco */
  --sem-bg:#ede6db; /* Bloques de semestre */
  --sem-border:#9f988e;

  --unlocked:#80aec3;        /* Ramos desbloqueados */
  --unlocked-border:#457387;

  --approved:#a2b38b;        /* Ramos aprobados */
  --approved-border:#768660;

  --blocked-bg:#eef1f3;      /* Ramos bloqueados */
  --blocked-ink:#5d6772;
  --blocked-border:#a9b2ba;

  --ink:#1c2630;
  --muted:#6b747d;

  --shadow: 0 6px 16px rgba(0,0,0,.07);
  --radius: 18px;
  --radius-sm: 12px;
}

/* Fondo + tipografía Caudex en toda la malla */
html,body{ height:100%; }
body{
  margin:0;
  font-family: "Caudex", serif;
  color:var(--ink);
  background: var(--bg);
}

/* Encabezado */
.topbar{
  position:sticky; top:0; z-index:5;
  backdrop-filter: blur(6px);
  background:linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.82));
  border-bottom:1px solid #e7e1d8;
  padding:10px 16px 8px;
}
.topbar h1{
  margin:4px 0 8px;
  font-size: clamp(18px, 2.4vw, 28px);
  letter-spacing:.2px;
}

.toolbar{
  display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap;
}

/* Leyenda */
.legend{
  display:flex; gap:10px; flex-wrap:wrap;
  font-size:12px;
}
.legend-item{
  display:inline-flex; align-items:center; gap:8px;
  border-radius:999px; padding:6px 10px; border:1px solid #e1d8cc;
  background:#fff;
}
.legend-item::before{
  content:""; width:14px; height:14px; border-radius:4px; display:inline-block;
  border:2px solid transparent;
}
.legend-item.unlocked::before{ background:var(--unlocked); border-color:var(--unlocked-border); }
.legend-item.blocked::before{ background:var(--blocked-bg); border:2px dashed var(--blocked-border); }
.legend-item.passed::before{ background:var(--approved); border-color:var(--approved-border); }

.actions{
  display:flex; align-items:center; gap:8px; flex-wrap:wrap;
}
.btn{
  font-family:"Caudex", serif;
  padding:8px 14px; border-radius:999px; border:1px solid var(--unlocked-border);
  background: var(--unlocked);
  color:#0f2a34; cursor:pointer;
  box-shadow: var(--shadow);
  transition: transform .15s ease, box-shadow .15s ease, background-color .25s ease, border-color .25s ease;
}
.btn:hover{ transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,.08); }
.btn:active{ transform: translateY(0); }
.btn.btn-outline{
  background:#fff; color:var(--ink); border-color:#c9c2b7;
}

/* Utilidades bajo la toolbar */
.utility{
  display:grid; grid-template-columns: 1fr auto; gap:16px; align-items:center;
  margin-top:10px;
}
.hint{ color:var(--muted); display:block; margin-top:10px; }

/* Progreso */
.progress{
  display:flex; align-items:center; gap:12px; min-width: 280px;
}
.progress .bar{
  width: 260px; height: 10px; background:#f1ece4; border:1px solid var(--sem-border);
  border-radius:999px; overflow:hidden;
}
.progress .fill{
  display:block; height:100%; background: var(--approved); transition: width .35s ease;
}
.progress .label{ font-size:14px; }

/* Buscador */
.searchbox{
  display:flex; flex-direction:column; gap:6px; justify-self:end;
}
#search-input{
  font-family:"Caudex", serif;
  width: 320px; max-width: 90vw;
  padding:8px 12px; border-radius:999px; border:1px solid var(--sem-border);
  background:#fff;
}
.search-info{
  background: var(--sem-bg);
  border:1px solid var(--sem-border);
  border-radius: 12px;
  padding:10px 12px;
  box-shadow: var(--shadow);
  max-width: min(520px, 92vw);
}

/* Contenedor principal */
#viewport{
  position:relative;
  padding:18px 12px 40px;
  overflow:auto;
}

/* Grilla de semestres: columnas lado a lado */
#malla{
  display:grid;
  grid-auto-flow: column;
  grid-auto-columns: minmax(260px, 280px);
  gap:18px;
  align-items:start;
  position:relative;
}

/* Tarjeta de semestre */
.semestre{
  background: var(--sem-bg);
  border:1px solid var(--sem-border);
  border-radius: var(--radius);
  padding:12px;
  box-shadow: var(--shadow);
}
.semestre h2{
  margin:4px 6px 10px;
  font-size:18px;
  font-weight:700;
  color:#2a2a2a;
  text-align:center;
}

/* Ramo */
.ramo{
  position:relative;
  padding:10px 10px;
  border-radius: var(--radius-sm);
  margin:8px 4px;
  line-height:1.25;
  user-select:none;
  border:2px solid transparent;
  cursor:pointer;
  box-shadow: 0 1px 0 rgba(0,0,0,0.04);
  transition:
    transform .12s ease,
    box-shadow .12s ease,
    background-color .25s ease,
    border-color .25s ease,
    color .25s ease,
    filter .25s ease;
}

/* Desbloqueado */
.ramo.desbloqueado{
  background: var(--unlocked);
  border-color: var(--unlocked-border);
}
/* Bloqueado */
.ramo.bloqueado{
  background: var(--blocked-bg);
  color: var(--blocked-ink);
  border:2px dashed var(--blocked-border);
  cursor:not-allowed;
  filter:saturate(0.3);
}
/* Aprobado */
.ramo.aprobado{
  background: var(--approved) !important;
  color:#12210f;
  border-color: var(--approved-border) !important;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.2), 0 2px 6px rgba(0,0,0,.12);
}

/* Hover para desbloqueados */
.ramo.desbloqueado:not(.aprobado):hover{
  transform: scale(1.03);
  box-shadow: 0 10px 20px rgba(0,0,0,.12);
}

/* Resaltado de caminos (sin líneas) */
.dim .ramo:not(.is-highlight){
  filter: grayscale(.35) opacity(.6);
}
.ramo.is-highlight{
  outline: 2px solid var(--unlocked-border);
  outline-offset: 1px;
}

/* Tooltip de requisitos (bloqueado) */
.tooltip{
  position:absolute;
  z-index:3;
  background: var(--sem-bg);
  color: var(--ink);
  border:1px solid var(--sem-border);
  border-radius: 12px;
  box-shadow: var(--shadow);
  padding:10px 12px;
  max-width: 320px;
  font-size:14px;
  pointer-events:none;
  opacity:0;
  transform: translateY(-4px);
  transition: opacity .18s ease, transform .18s ease;
}
.tooltip.show{
  opacity:1;
  transform: translateY(0);
}

/* Animación pulse al saltar desde el buscador */
@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(69,115,135,.55); }
  70% { box-shadow: 0 0 0 10px rgba(69,115,135,0); }
  100% { box-shadow: 0 0 0 0 rgba(69,115,135,0); }
}
.ramo.pulse{
  animation: pulse 1s ease-out 2;
}

/* Footer */
.foot{
  padding:14px 16px 24px;
  color:var(--muted);
  text-align:center;
}
